---
import { getTeamMembers, getOffers, getPartners, getConfigByID } from "../lib/API";
import type { TeamMember, Offer, Partner } from "../lib/types";
import Base from "../layouts/Base.astro";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import Map from "../components/Map.astro";

const teamMembers: TeamMember[] = await getTeamMembers();

const settings = await getConfigByID("5eUmE4yWNEM9xNibICQaWh");

console.log(settings);

const offers: Offer[] = await getOffers();
const partners: Partner[] = await getPartners();

---

<Base>
  <main>
    <!-- TEAM -->
    <section>
      <h2 id="team">Team</h2>
      {
        teamMembers.map((item) => (
          <a href={`/team/${item.props.slug}`}>
            <article>
              <h2 set:html={item.props.name} />
              <img
                src={item.props.image.url}
                alt={item.props.image.description}
              />
            </article>
          </a>
        ))
      }
    </section>
    <!-- END TEAM -->
    <!-- ANGEBOT -->
    <section>
      <h2 id="therapy">Therapien</h2>
      {
        offers.map((item) => (
          <a href={`/angebot/${item.props.slug}`}>
            <article>
              <h2 set:html={item.props.name} />
              {item.props.image && (
                <img
                  src={item.props.image.url}
                  alt={item.props.image.description}
                />
              )}

              <div set:html={documentToHtmlString(item.props.intro)} />
            </article>
          </a>
        ))
      }
    </section>
    <!-- END ANGEBOT -->
    <section>
      <h2 id="contact">Kontakt</h2>
    </section>
	<Map data={settings.data} />
    <section class="p-4">
      <h2 class="text-2xl text-center mb-3" id="partners">Unsere Partner</h2>
      <ul class="flex flex-wrap justify-around font-smallCaps text-lg">
        {
          partners.map((item, index) => (
			<>
            <li>
              <a class="hover:underline underline-offset-4 text-brand" href={item.props.link} set:html={item.props.name} />
            </li>
			  {index < partners.length - 1 && <span> â€¢ </span>}
			  </>
          ))
        }
      </ul>
    </section>
  </main>
</Base>
